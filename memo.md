#### 2dporous-wd-change.f

２次元のポーラスディスクモデル、KK-scheme改

##### 計算領域

- 分割数　NX=1501 x NY=1001
- 領域　$X_{LEN}=15 \times Y_{LEN}=10$　（無次元）
- $X_{LEN}$をNX-1で分割し格子幅$\Delta x=0.01$とする

##### 計算格子

- $X \in [-5, 15],\,Y \in[-5,10]$の領域をとり、座標$(0,0)$が風車位置
- 直交等間隔格子
- スタガード配置

##### ポーラスディスク

- `IA=500, IB=502`, `JA=426, JB=576`のインデクス範囲
- x方向２セル（3点）、y方向149セル（150点）の範囲
- 大きさにして$0.02 \times 1.5$​
- `pfunc.dat`の内容をファイルから読み込み、風車の直径方向（インデクスＪ）の分布として$Pfunc \times C_{DD}$の値で`DFUNC(i,j)`に保存
- $F_i=-C_{RC} \cdot f(\frac{y}{R},\frac{z}{R}) \cdot \bar{u_i}V,\quad V=\sqrt{\bar{u}^2+\bar{v}^2+\bar{w}^2}$​
- Pfuncのデータは関数$f$の分布形状で$0\sim 1$のガウス分布

##### 流入条件

- `time-hist-inflow_5.0deg.dat`にu, vの時刻履歴が書かれており、これを`UUIN(t),VVIN(t)`に読み込んで各時刻の境界条件として使う
- ガイドセルに値を入れる

##### 流出条件

- `i=NX`についてはUは対流流出、Vはノイマン
- `i=NX+1`以降についてはノイマン

##### 平均値

- `UAVE, VAVE, PAVE`の各配列に保持

##### 線形計算　

- SOR法で不足緩和 $\omega=0.9, \varepsilon=1.0\times 10^{-3}$​​ 
- 最大反復回数100回

##### 計算パラメータ

- 計算ステップ数：320000
- 積分幅 $\Delta t=1.0\times 10^{-3}$​ Courant数にして0.1
- レイノルズ数$10^4$​
- $C_{DD}=13.0$

##### 計算ループ

- 配列範囲
  - `(0:NX+2)`
- 内点
  - `U: (2:NX-1,2:NY)`
  - `V: (2:NX,2:NY-1)`
  - `P: (2:NX, 2:NY)`



圧力は全周ノイマンで、空間平均値で引き戻す



境界値`P(1,j), P(NX+1,j), P(i,1), P(i,NY+1)`ノイマン条件

可視化データを`IPROG=800`ステップ毎に生成

可視化のためにセルセンターの速度を算術平均で作り、出力



##### 時間平均

- UAVEに値を足し込み、終了時に平均化



##### ログ

NSOR=100ステップ毎にCD、圧力反復回数、変化量のrmsをモニタに出力